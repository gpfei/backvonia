{
  # Optional: set in .env as EMAIL=you@example.com for ACME account
  email {$EMAIL}
}

# Set DOMAIN in .env, e.g. DOMAIN=api.talevonia.app
{$DOMAIN} {
  encode gzip
  # For rootless deployments, run Caddy outside the compose network and set:
  # UPSTREAM=127.0.0.1:8080
  # For docker compose local dev, you can set:
  # UPSTREAM=backvonia:8080
  reverse_proxy {$UPSTREAM:127.0.0.1:8080}

  # Basic security headers
  header {
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    Referrer-Policy "no-referrer"
  }

  log {
    output stdout
    format console
  }
}
